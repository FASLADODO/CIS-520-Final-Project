function K = chiSquared_kernel(X, X2)

% one=(X-X2).^2;
% two= one./(X+X2);
% K= exp(-sum(two));

n = size(X,1);
m = size(X2,1);
K = zeros(m, n);

transX=X';
transX2=X2';
for i=1:m
    for j=1:n          
one = ((transX2(:,i)-transX(:,j)).^2) ./ (transX2(:,i)+transX(:,j));
K(i,j)= 1-(sum(one)./2);
    end
end
